<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Manga - Media App</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="Resources/styles.css"> <!-- Your CSS file -->
</head>
<body>
    <div class="app-container">
        <header class="hero-section" style="background-image: url('https://cdn.myanimelist.net/images/anime/1770/97704l.jpg');">
            <div class="hero-content">
                <div class="hero-poster">
                    <img src="https://cdn.myanimelist.net/images/manga/2/253146.jpg" alt="Manga Poster">
                </div>
                <div class="hero-details">
                    <span class="title-logo" style="padding-bottom: 10px;">One Piece</span> <!-- Placeholder -->
                    <button class="continue-button">
                        <i class="fas fa-book-open"></i> Explore Manga
                    </button>
                </div>
            </div>
        </header>

        <main class="main-content">
            <section id="manga-explore-section">
                <h2 class="section-title">Explore Manga</h2>
                <div class="item-list" id="manga-list">
                    <!-- Manga items will be populated here by JavaScript -->
                    <!-- Example static item removed to be replaced by dynamic content -->
                </div>
            </section>
            <!-- You can add more sections here -->
        </main>
    </div> <!-- .app-container ends -->

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mangaListContainer = document.getElementById('manga-list');

            // Function to fetch top manga from Jikan API
            async function fetchTopManga() {
                try {
                    // Jikan API endpoint for top manga
                    const response = await fetch('https://api.jikan.moe/v4/top/manga?limit=10'); // Fetching top 10 manga
                    if (!response.ok) {
                        throw new Error(`Jikan API error: ${response.status} ${response.statusText}`);
                    }
                    const data = await response.json();
                    displayManga(data.data);
                } catch (error) {
                    console.error("Failed to fetch manga data:", error);
                    if (mangaListContainer) {
                        mangaListContainer.innerHTML = '<p>Error loading manga. Please try again later.</p>';
                    }
                }
            }

            // Function to display manga data in the list
            function displayManga(mangaData) {
                if (!mangaListContainer) return;
                mangaListContainer.innerHTML = ''; // Clear any existing content or placeholders

                if (!mangaData || mangaData.length === 0) {
                    mangaListContainer.innerHTML = '<p>No manga found.</p>';
                    return;
                }

                mangaData.forEach(manga => {
                    const listItem = document.createElement('div');
                    listItem.classList.add('list-item');
                    listItem.style.cursor = 'pointer'; // Make it visually clickable
                    // Consider adding a type parameter if series-info.html handles both anime and manga
                    listItem.addEventListener('click', () => {
                        window.location.href = `series-info.html?id=${manga.mal_id}&manga=true`;
                    });

                    const thumbnailDiv = document.createElement('div');
                    thumbnailDiv.classList.add('item-thumbnail');
                    const thumbnailImg = document.createElement('img');
                    thumbnailImg.src = manga.images?.jpg?.image_url || 'https://placehold.co/60x80/555/fff?text=N/A';
                    thumbnailImg.alt = manga.title_english || manga.title;
                    thumbnailDiv.appendChild(thumbnailImg);

                    const detailsDiv = document.createElement('div');
                    detailsDiv.classList.add('item-details');
                    const titleH3 = document.createElement('h3');
                    titleH3.classList.add('item-title');
                    titleH3.textContent = manga.title_english || manga.title;
                    detailsDiv.appendChild(titleH3);

                    const metaDiv = document.createElement('div');
                    metaDiv.classList.add('item-meta');

                    if (manga.score) {
                        const scoreSpan = document.createElement('span');
                        scoreSpan.classList.add('meta-pill');
                        scoreSpan.textContent = `${manga.score}/10`;
                        metaDiv.appendChild(scoreSpan);
                    }

                    if (manga.chapters) {
                        const chaptersSpan = document.createElement('span');
                        chaptersSpan.classList.add('meta-pill');
                        chaptersSpan.textContent = `${manga.chapters} CH`;
                        metaDiv.appendChild(chaptersSpan);
                    } else if (manga.volumes) { // Fallback to volumes if chapters not available
                        const volumesSpan = document.createElement('span');
                        volumesSpan.classList.add('meta-pill');
                        volumesSpan.textContent = `${manga.volumes} VOL`;
                        metaDiv.appendChild(volumesSpan);
                    }
                    detailsDiv.appendChild(metaDiv);
                    

                    const arrowDiv = document.createElement('div');
                    arrowDiv.classList.add('item-arrow');
                    const arrowIcon = document.createElement('i');
                    arrowIcon.classList.add('fas', 'fa-chevron-right');
                    arrowDiv.appendChild(arrowIcon);

                    listItem.appendChild(thumbnailDiv);
                    listItem.appendChild(detailsDiv);
                    listItem.appendChild(arrowDiv);

                    mangaListContainer.appendChild(listItem);
                });
            }
            
            // Initial fetch of manga data
            if (mangaListContainer) { // Ensure the container exists before trying to fetch
                fetchTopManga();
            } else {
                console.error("Manga list container not found.");
            }
        });
    </script>
</body>
</html>